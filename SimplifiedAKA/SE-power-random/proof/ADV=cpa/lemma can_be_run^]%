lemma can_be_run:
  exists-trace
  "∃ C S secret #i #j.
         (A_Secret( C, S, secret ) @ #i) ∧
         (B_Secret( C, S, secret ) @ #j)"
simplify
solve( A1_state( $A, $B, na ) ▶₀ #i )
  case A1
  solve( !A1( k, $A, $B ) ▶₂ #i )
    case Init
    solve( B1_rqn( r2 ) ▶₃ #i )
      case B1
      solve( B1_state( $A, $B, z, ~na ) ▶₀ #j )
        case B1
        solve( !KU( h(~na) ) @ #vk.10 )
          case B1
          solve( !KU( h(~nb) ) @ #vk.11 )
            case A2
            solve( !KU( ~na^PRF(~k, ~r1) ) @ #vk.12 )
              case A1
              solve( !KU( ~nb^PRF(~k, ~r2) ) @ #vk.12 )
                case B1
                SOLVED // trace found
              qed
            qed
          qed
        qed
      qed
    qed
  qed
qed

lemma A_secrecy_na:
  all-traces
  "∀ C S x #i #o.
         ((A_Secret_na( C, S, x ) @ #i) ∧ (Ora( ) @ #o)) ⇒
         (¬(∃ #j. K( x ) @ #j))"
simplify
solve( A1_state( $A, $B, x ) ▶₀ #i )
  case A1
  solve( !A1( k, $A, $B ) ▶₂ #i )
    case Init
    solve( B1_rqn( r2 ) ▶₃ #i )
      case B1
      solve( OraE( k.1 ) ▶₁ #o )
        case Init
        solve( !KU( ~na ) @ #vk.10 )
          case A1
          solve( !KU( h(~na) ) @ #vk.9 )
            case A2
            by contradiction /* cyclic */
          next
            case B1
            solve( !KU( PRF(~k, ~r1) ) @ #vk.13 )
              case EncOracle_case_1
              solve( !KU( z.1^inv(PRF(~k, ~r)) ) @ #vk.12 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case EncOracle_case_2
              solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_PRF
                solve( !KU( ~k ) @ #vk.18 )
                  case EncOracle
                  by contradiction /* cyclic */
                qed
              qed
            next
              case EncOracle_case_3
              solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_PRF
                solve( !KU( ~k ) @ #vk.18 )
                  case EncOracle
                  by contradiction /* cyclic */
                qed
              qed
            next
              case EncOracle_case_4
              solve( !KU( PRF(~k, ~r) ) @ #vk.19 )
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_PRF
                solve( !KU( ~k ) @ #vk.20 )
                  case EncOracle
                  by contradiction /* cyclic */
                qed
              qed
            next
              case EncOracle_case_5
              solve( !KU( x^(x.1*inv(PRF(~k, ~r))) ) @ #vk.12 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case B1_case_3
                by contradiction /* impossible chain */
              next
                case EncOracle_case_1
                by contradiction /* cyclic */
              next
                case EncOracle_case_2
                by contradiction /* cyclic */
              next
                case EncOracle_case_3
                by contradiction /* cyclic */
              next
                case EncOracle_case_4
                by contradiction /* cyclic */
              next
                case EncOracle_case_5
                by contradiction /* cyclic */
              next
                case EncOracle_case_6
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case EncOracle_case_6
              solve( !KU( x^inv((x.1*PRF(~k, ~r))) ) @ #vk.12 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case EncOracle_case_1
                by contradiction /* cyclic */
              next
                case EncOracle_case_2
                by contradiction /* cyclic */
              next
                case EncOracle_case_3
                by contradiction /* cyclic */
              next
                case EncOracle_case_4
                by contradiction /* cyclic */
              next
                case EncOracle_case_5
                by contradiction /* cyclic */
              next
                case EncOracle_case_6
                by contradiction /* cyclic */
              next
                case EncOracle_case_7
                by contradiction /* cyclic */
              next
                case EncOracle_case_8
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case EncOracle_case_7
              solve( !KU( x^(x.1*inv((x.2*PRF(~k, ~r)))) ) @ #vk.12 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case B1_case_3
                by contradiction /* impossible chain */
              next
                case B1_case_4
                by contradiction /* impossible chain */
              next
                case EncOracle_case_01
                by contradiction /* cyclic */
              next
                case EncOracle_case_02
                by contradiction /* cyclic */
              next
                case EncOracle_case_03
                by contradiction /* cyclic */
              next
                case EncOracle_case_04
                by contradiction /* cyclic */
              next
                case EncOracle_case_05
                by contradiction /* cyclic */
              next
                case EncOracle_case_06
                by contradiction /* cyclic */
              next
                case EncOracle_case_07
                by contradiction /* cyclic */
              next
                case EncOracle_case_08
                by contradiction /* cyclic */
              next
                case EncOracle_case_09
                by contradiction /* cyclic */
              next
                case EncOracle_case_10
                by contradiction /* cyclic */
              next
                case EncOracle_case_11
                by contradiction /* cyclic */
              next
                case EncOracle_case_12
                by contradiction /* cyclic */
              next
                case EncOracle_case_13
                by contradiction /* cyclic */
              next
                case EncOracle_case_14
                by contradiction /* cyclic */
              next
                case EncOracle_case_15
                by contradiction /* cyclic */
              next
                case EncOracle_case_16
                by contradiction /* cyclic */
              next
                case EncOracle_case_17
                by contradiction /* cyclic */
              next
                case EncOracle_case_18
                by contradiction /* cyclic */
              next
                case EncOracle_case_19
                by contradiction /* cyclic */
              next
                case EncOracle_case_20
                by contradiction /* cyclic */
              next
                case EncOracle_case_21
                by contradiction /* cyclic */
              next
                case EncOracle_case_22
                by contradiction /* cyclic */
              next
                case EncOracle_case_23
                by contradiction /* cyclic */
              next
                case EncOracle_case_24
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.14 )
                case EncOracle_case_1
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( z.1^inv(PRF(~k, ~r)) ) @ #vk.15 )
                    case B1_case_1
                    by solve( (#vl.2, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_2
                    by solve( (#vl.2, 0) ~~> (#vk.3, 0) )
                  next
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_2
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( PRF(~k, ~r) ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_PRF
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_3
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( PRF(~k, ~r) ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_PRF
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_4
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( PRF(~k, ~r) ) @ #vk.21 )
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_PRF
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_5
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( x^(x.1*inv(PRF(~k, ~r))) ) @ #vk.15 )
                    case B1_case_1
                    by solve( (#vr.11, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_2
                    by solve( (#vr.11, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_3
                    by solve( (#vr.11, 0) ~~> (#vk.3, 0) )
                  next
                    case EncOracle_case_1
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_2
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_3
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_4
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_5
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_6
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_6
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( x^inv((x.1*PRF(~k, ~r))) ) @ #vk.15 )
                    case B1_case_1
                    by solve( (#vr.11, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_2
                    by solve( (#vr.11, 0) ~~> (#vk.3, 0) )
                  next
                    case EncOracle_case_1
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_2
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_3
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_4
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_5
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_6
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_7
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_8
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_7
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( x^(x.1*inv((x.2*PRF(~k, ~r)))) ) @ #vk.15 )
                    case B1_case_1
                    by solve( (#vr.11, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_2
                    by solve( (#vr.11, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_3
                    by solve( (#vr.11, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_4
                    by solve( (#vr.11, 0) ~~> (#vk.3, 0) )
                  next
                    case EncOracle_case_01
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_02
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_03
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_04
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_05
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_06
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_07
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_08
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_09
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_10
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_11
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_12
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_13
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_14
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_15
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_16
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_17
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_18
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_19
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_20
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_21
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_22
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_23
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_24
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case EncOracle_case_1
            solve( !KU( PRF(~k, ~r1) ) @ #vk.13 )
              case EncOracle
              solve( !KU( z.1^inv(PRF(~k, ~r)) ) @ #vk.11 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.14 )
                case EncOracle
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( z.1^inv(PRF(~k, ~r)) ) @ #vk.14 )
                    case B1_case_1
                    by contradiction /* impossible chain */
                  next
                    case B1_case_2
                    by contradiction /* impossible chain */
                  next
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case EncOracle_case_2
            solve( !KU( PRF(~k, ~r1) ) @ #vk.13 )
              case EncOracle
              solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_PRF
                solve( !KU( ~k ) @ #vk.18 )
                  case EncOracle
                  by contradiction /* cyclic */
                qed
              qed
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.18 )
                case EncOracle
                solve( !KU( ~r1 ) @ #vk.19 )
                  case EncOracle
                  solve( !KU( PRF(~k, ~r) ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_PRF
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case EncOracle_case_3
            solve( !KU( PRF(~k, ~r1) ) @ #vk.13 )
              case EncOracle
              solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_PRF
                solve( !KU( ~k ) @ #vk.18 )
                  case EncOracle
                  by contradiction /* cyclic */
                qed
              qed
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.18 )
                case EncOracle
                solve( !KU( ~r1 ) @ #vk.19 )
                  case EncOracle
                  solve( !KU( PRF(~k, ~r) ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_PRF
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case EncOracle_case_4
            solve( !KU( PRF(~k, ~r1) ) @ #vk.13 )
              case EncOracle
              solve( !KU( PRF(~k, ~r) ) @ #vk.19 )
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_PRF
                solve( !KU( ~k ) @ #vk.20 )
                  case EncOracle
                  by contradiction /* cyclic */
                qed
              qed
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.20 )
                case EncOracle
                solve( !KU( ~r1 ) @ #vk.21 )
                  case EncOracle
                  solve( !KU( PRF(~k, ~r) ) @ #vk.21 )
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_PRF
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case EncOracle_case_5
            solve( !KU( x^(x.1*inv(PRF(~k, ~r))) ) @ #vk.10 )
              case B1_case_1
              by contradiction /* impossible chain */
            next
              case B1_case_2
              by contradiction /* impossible chain */
            next
              case B1_case_3
              by contradiction /* impossible chain */
            next
              case EncOracle_case_1
              by contradiction /* cyclic */
            next
              case EncOracle_case_2
              by contradiction /* cyclic */
            next
              case EncOracle_case_3
              by contradiction /* cyclic */
            next
              case EncOracle_case_4
              by contradiction /* cyclic */
            next
              case EncOracle_case_5
              by contradiction /* cyclic */
            next
              case EncOracle_case_6
              by contradiction /* cyclic */
            next
              case c_exp
              by contradiction /* cyclic */
            qed
          next
            case EncOracle_case_6
            solve( !KU( PRF(~k, ~r1) ) @ #vk.13 )
              case EncOracle
              solve( !KU( x^inv((x.1*PRF(~k, ~r))) ) @ #vk.11 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case EncOracle_case_1
                by contradiction /* cyclic */
              next
                case EncOracle_case_2
                by contradiction /* cyclic */
              next
                case EncOracle_case_3
                by contradiction /* cyclic */
              next
                case EncOracle_case_4
                by contradiction /* cyclic */
              next
                case EncOracle_case_5
                by contradiction /* cyclic */
              next
                case EncOracle_case_6
                by contradiction /* cyclic */
              next
                case EncOracle_case_7
                by contradiction /* cyclic */
              next
                case EncOracle_case_8
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.15 )
                case EncOracle
                solve( !KU( ~r1 ) @ #vk.16 )
                  case EncOracle
                  solve( !KU( x^inv((x.1*PRF(~k, ~r))) ) @ #vk.14 )
                    case B1_case_1
                    by contradiction /* impossible chain */
                  next
                    case B1_case_2
                    by contradiction /* impossible chain */
                  next
                    case EncOracle_case_1
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_2
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_3
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_4
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_5
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_6
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_7
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_8
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case EncOracle_case_7
            solve( !KU( x^(x.1*inv((x.2*PRF(~k, ~r)))) ) @ #vk.10 )
              case B1_case_1
              by contradiction /* impossible chain */
            next
              case B1_case_2
              by contradiction /* impossible chain */
            next
              case B1_case_3
              by contradiction /* impossible chain */
            next
              case B1_case_4
              by contradiction /* impossible chain */
            next
              case EncOracle_case_01
              by contradiction /* cyclic */
            next
              case EncOracle_case_02
              by contradiction /* cyclic */
            next
              case EncOracle_case_03
              by contradiction /* cyclic */
            next
              case EncOracle_case_04
              by contradiction /* cyclic */
            next
              case EncOracle_case_05
              by contradiction /* cyclic */
            next
              case EncOracle_case_06
              by contradiction /* cyclic */
            next
              case EncOracle_case_07
              by contradiction /* cyclic */
            next
              case EncOracle_case_08
              by contradiction /* cyclic */
            next
              case EncOracle_case_09
              by contradiction /* cyclic */
            next
              case EncOracle_case_10
              by contradiction /* cyclic */
            next
              case EncOracle_case_11
              by contradiction /* cyclic */
            next
              case EncOracle_case_12
              by contradiction /* cyclic */
            next
              case EncOracle_case_13
              by contradiction /* cyclic */
            next
              case EncOracle_case_14
              by contradiction /* cyclic */
            next
              case EncOracle_case_15
              by contradiction /* cyclic */
            next
              case EncOracle_case_16
              by contradiction /* cyclic */
            next
              case EncOracle_case_17
              by contradiction /* cyclic */
            next
              case EncOracle_case_18
              by contradiction /* cyclic */
            next
              case EncOracle_case_19
              by contradiction /* cyclic */
            next
              case EncOracle_case_20
              by contradiction /* cyclic */
            next
              case EncOracle_case_21
              by contradiction /* cyclic */
            next
              case EncOracle_case_22
              by contradiction /* cyclic */
            next
              case EncOracle_case_23
              by contradiction /* cyclic */
            next
              case EncOracle_case_24
              by contradiction /* cyclic */
            next
              case c_exp
              by contradiction /* cyclic */
            qed
          next
            case c_h
            solve( !KU( PRF(~k, ~r1) ) @ #vk.13 )
              case EncOracle_case_1
              solve( !KU( z.1^inv(PRF(~k, ~r)) ) @ #vk.11 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case EncOracle_case_2
              solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_PRF
                solve( !KU( ~k ) @ #vk.18 )
                  case EncOracle
                  by contradiction /* cyclic */
                qed
              qed
            next
              case EncOracle_case_3
              solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_PRF
                solve( !KU( ~k ) @ #vk.18 )
                  case EncOracle
                  by contradiction /* cyclic */
                qed
              qed
            next
              case EncOracle_case_4
              solve( !KU( PRF(~k, ~r) ) @ #vk.19 )
                case EncOracle
                by contradiction /* cyclic */
              next
                case c_PRF
                solve( !KU( ~k ) @ #vk.20 )
                  case EncOracle
                  by contradiction /* cyclic */
                qed
              qed
            next
              case EncOracle_case_5
              solve( !KU( x^(x.1*inv(PRF(~k, ~r))) ) @ #vk.11 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case B1_case_3
                by contradiction /* impossible chain */
              next
                case EncOracle_case_1
                by contradiction /* cyclic */
              next
                case EncOracle_case_2
                by contradiction /* cyclic */
              next
                case EncOracle_case_3
                by contradiction /* cyclic */
              next
                case EncOracle_case_4
                by contradiction /* cyclic */
              next
                case EncOracle_case_5
                by contradiction /* cyclic */
              next
                case EncOracle_case_6
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case EncOracle_case_6
              solve( !KU( x^inv((x.1*PRF(~k, ~r))) ) @ #vk.11 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case EncOracle_case_1
                by contradiction /* cyclic */
              next
                case EncOracle_case_2
                by contradiction /* cyclic */
              next
                case EncOracle_case_3
                by contradiction /* cyclic */
              next
                case EncOracle_case_4
                by contradiction /* cyclic */
              next
                case EncOracle_case_5
                by contradiction /* cyclic */
              next
                case EncOracle_case_6
                by contradiction /* cyclic */
              next
                case EncOracle_case_7
                by contradiction /* cyclic */
              next
                case EncOracle_case_8
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case EncOracle_case_7
              solve( !KU( x^(x.1*inv((x.2*PRF(~k, ~r)))) ) @ #vk.11 )
                case B1_case_1
                by contradiction /* impossible chain */
              next
                case B1_case_2
                by contradiction /* impossible chain */
              next
                case B1_case_3
                by contradiction /* impossible chain */
              next
                case B1_case_4
                by contradiction /* impossible chain */
              next
                case EncOracle_case_01
                by contradiction /* cyclic */
              next
                case EncOracle_case_02
                by contradiction /* cyclic */
              next
                case EncOracle_case_03
                by contradiction /* cyclic */
              next
                case EncOracle_case_04
                by contradiction /* cyclic */
              next
                case EncOracle_case_05
                by contradiction /* cyclic */
              next
                case EncOracle_case_06
                by contradiction /* cyclic */
              next
                case EncOracle_case_07
                by contradiction /* cyclic */
              next
                case EncOracle_case_08
                by contradiction /* cyclic */
              next
                case EncOracle_case_09
                by contradiction /* cyclic */
              next
                case EncOracle_case_10
                by contradiction /* cyclic */
              next
                case EncOracle_case_11
                by contradiction /* cyclic */
              next
                case EncOracle_case_12
                by contradiction /* cyclic */
              next
                case EncOracle_case_13
                by contradiction /* cyclic */
              next
                case EncOracle_case_14
                by contradiction /* cyclic */
              next
                case EncOracle_case_15
                by contradiction /* cyclic */
              next
                case EncOracle_case_16
                by contradiction /* cyclic */
              next
                case EncOracle_case_17
                by contradiction /* cyclic */
              next
                case EncOracle_case_18
                by contradiction /* cyclic */
              next
                case EncOracle_case_19
                by contradiction /* cyclic */
              next
                case EncOracle_case_20
                by contradiction /* cyclic */
              next
                case EncOracle_case_21
                by contradiction /* cyclic */
              next
                case EncOracle_case_22
                by contradiction /* cyclic */
              next
                case EncOracle_case_23
                by contradiction /* cyclic */
              next
                case EncOracle_case_24
                by contradiction /* cyclic */
              next
                case c_exp
                by contradiction /* cyclic */
              qed
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.14 )
                case EncOracle_case_1
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( z.1^inv(PRF(~k, ~r)) ) @ #vk.14 )
                    case B1_case_1
                    by solve( (#vl.1, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_2
                    by solve( (#vl.1, 0) ~~> (#vk.3, 0) )
                  next
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_2
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( PRF(~k, ~r) ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_PRF
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_3
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( PRF(~k, ~r) ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_PRF
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_4
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( PRF(~k, ~r) ) @ #vk.21 )
                    case EncOracle
                    by contradiction /* cyclic */
                  next
                    case c_PRF
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_5
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( x^(x.1*inv(PRF(~k, ~r))) ) @ #vk.14 )
                    case B1_case_1
                    by solve( (#vr.8, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_2
                    by solve( (#vr.8, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_3
                    by solve( (#vr.8, 0) ~~> (#vk.3, 0) )
                  next
                    case EncOracle_case_1
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_2
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_3
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_4
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_5
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_6
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_6
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( x^inv((x.1*PRF(~k, ~r))) ) @ #vk.14 )
                    case B1_case_1
                    by solve( (#vr.8, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_2
                    by solve( (#vr.8, 0) ~~> (#vk.3, 0) )
                  next
                    case EncOracle_case_1
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_2
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_3
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_4
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_5
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_6
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_7
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_8
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle_case_7
                solve( !KU( ~r1 ) @ #vk.15 )
                  case EncOracle
                  solve( !KU( x^(x.1*inv((x.2*PRF(~k, ~r)))) ) @ #vk.14 )
                    case B1_case_1
                    by solve( (#vr.8, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_2
                    by solve( (#vr.8, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_3
                    by solve( (#vr.8, 0) ~~> (#vk.3, 0) )
                  next
                    case B1_case_4
                    by solve( (#vr.8, 0) ~~> (#vk.3, 0) )
                  next
                    case EncOracle_case_01
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_02
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_03
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_04
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_05
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_06
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_07
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_08
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_09
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_10
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_11
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_12
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_13
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_14
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_15
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_16
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_17
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_18
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_19
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_20
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_21
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_22
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_23
                    by contradiction /* cyclic */
                  next
                    case EncOracle_case_24
                    by contradiction /* cyclic */
                  next
                    case c_exp
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          qed
        next
          case EncOracle_case_1
          solve( !KU( h(~na) ) @ #vk.9 )
            case A2
            by contradiction /* cyclic */
          next
            case B1
            solve( !KU( z.1^inv(PRF(~k, ~r)) ) @ #vk.10 )
              case A1_case_1
              solve( (#vl, 0) ~~> (#vk, 0) )
                case Var_fresh_na
                solve( !KU( PRF(~k, ~r1) ) @ #vk.14 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.16 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case A1_case_2
              solve( (#vl, 0) ~~> (#vk, 0) )
                case Var_fresh_na
                solve( !KU( PRF(~k, ~r1) ) @ #vk.15 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.17 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case B1_case_1
              by solve( (#vl, 0) ~~> (#vk, 0) )
            next
              case B1_case_2
              by solve( (#vl, 0) ~~> (#vk, 0) )
            next
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_exp
              by contradiction /* cyclic */
            qed
          next
            case EncOracle
            solve( !KU( z.1^inv(PRF(~k, ~r)) ) @ #vk.10 )
              case A1_case_1
              by contradiction /* impossible chain */
            next
              case A1_case_2
              by contradiction /* impossible chain */
            next
              case B1_case_1
              by contradiction /* impossible chain */
            next
              case B1_case_2
              by contradiction /* impossible chain */
            next
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_exp
              by contradiction /* cyclic */
            qed
          next
            case c_h
            solve( !KU( z.1^inv(PRF(~k, ~r)) ) @ #vk.10 )
              case A1_case_1
              solve( (#vl, 0) ~~> (#vk, 0) )
                case Var_fresh_na
                solve( !KU( PRF(~k, ~r1) ) @ #vk.14 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.16 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case A1_case_2
              solve( (#vl, 0) ~~> (#vk, 0) )
                case Var_fresh_na
                solve( !KU( PRF(~k, ~r1) ) @ #vk.15 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.17 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case B1_case_1
              by solve( (#vl, 0) ~~> (#vk, 0) )
            next
              case B1_case_2
              by solve( (#vl, 0) ~~> (#vk, 0) )
            next
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_exp
              by contradiction /* cyclic */
            qed
          qed
        next
          case EncOracle_case_2
          solve( !KU( h(~na) ) @ #vk.9 )
            case A2
            by contradiction /* cyclic */
          next
            case B1
            solve( !KU( PRF(~k, ~r) ) @ #vk.15 )
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.16 )
                case EncOracle
                by contradiction /* cyclic */
              qed
            qed
          next
            case EncOracle
            solve( !KU( PRF(~k, ~r) ) @ #vk.15 )
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.16 )
                case EncOracle
                by contradiction /* cyclic */
              qed
            qed
          next
            case c_h
            solve( !KU( PRF(~k, ~r) ) @ #vk.15 )
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.16 )
                case EncOracle
                by contradiction /* cyclic */
              qed
            qed
          qed
        next
          case EncOracle_case_3
          solve( !KU( h(~na) ) @ #vk.9 )
            case A2
            by contradiction /* cyclic */
          next
            case B1
            solve( !KU( PRF(~k, ~r) ) @ #vk.15 )
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.16 )
                case EncOracle
                by contradiction /* cyclic */
              qed
            qed
          next
            case EncOracle
            solve( !KU( PRF(~k, ~r) ) @ #vk.15 )
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.16 )
                case EncOracle
                by contradiction /* cyclic */
              qed
            qed
          next
            case c_h
            solve( !KU( PRF(~k, ~r) ) @ #vk.15 )
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.16 )
                case EncOracle
                by contradiction /* cyclic */
              qed
            qed
          qed
        next
          case EncOracle_case_4
          solve( !KU( h(~na) ) @ #vk.9 )
            case A2
            by contradiction /* cyclic */
          next
            case B1
            solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.18 )
                case EncOracle
                by contradiction /* cyclic */
              qed
            qed
          next
            case EncOracle
            solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.18 )
                case EncOracle
                by contradiction /* cyclic */
              qed
            qed
          next
            case c_h
            solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
              case EncOracle
              by contradiction /* cyclic */
            next
              case c_PRF
              solve( !KU( ~k ) @ #vk.18 )
                case EncOracle
                by contradiction /* cyclic */
              qed
            qed
          qed
        next
          case EncOracle_case_5
          solve( !KU( x^(x.1*inv(PRF(~k, ~r))) ) @ #vk.10 )
            case A1_case_1
            solve( (#vr.5, 0) ~~> (#vk, 0) )
              case Var_fresh_na
              solve( !KU( h(~na) ) @ #vk.10 )
                case A2
                by contradiction /* cyclic */
              next
                case B1
                solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle
                by contradiction /* impossible chain */
              next
                case c_h
                solve( !KU( PRF(~k, ~r) ) @ #vk.17 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case A1_case_2
            solve( (#vr.5, 0) ~~> (#vk, 0) )
              case Var_fresh_na
              solve( !KU( h(~na) ) @ #vk.10 )
                case A2
                by contradiction /* cyclic */
              next
                case B1
                solve( !KU( PRF(~k, ~r1) ) @ #vk.17 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.20 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle
                by contradiction /* impossible chain */
              next
                case c_h
                solve( !KU( PRF(~k, ~r1) ) @ #vk.17 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.20 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case A1_case_3
            solve( (#vr.5, 0) ~~> (#vk, 0) )
              case Var_fresh_na
              solve( !KU( h(~na) ) @ #vk.10 )
                case A2
                by contradiction /* cyclic */
              next
                case B1
                solve( !KU( PRF(~k, ~r1) ) @ #vk.17 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle
                by contradiction /* impossible chain */
              next
                case c_h
                solve( !KU( PRF(~k, ~r1) ) @ #vk.17 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case B1_case_1
            by solve( (#vr.5, 0) ~~> (#vk, 0) )
          next
            case B1_case_2
            by solve( (#vr.5, 0) ~~> (#vk, 0) )
          next
            case B1_case_3
            by solve( (#vr.5, 0) ~~> (#vk, 0) )
          next
            case EncOracle_case_1
            by contradiction /* cyclic */
          next
            case EncOracle_case_2
            by contradiction /* cyclic */
          next
            case EncOracle_case_3
            by contradiction /* cyclic */
          next
            case EncOracle_case_4
            by contradiction /* cyclic */
          next
            case EncOracle_case_5
            by contradiction /* cyclic */
          next
            case EncOracle_case_6
            by contradiction /* cyclic */
          next
            case c_exp
            by contradiction /* cyclic */
          qed
        next
          case EncOracle_case_6
          solve( !KU( h(~na) ) @ #vk.9 )
            case A2
            by contradiction /* cyclic */
          next
            case B1
            solve( !KU( x^inv((x.1*PRF(~k, ~r))) ) @ #vk.10 )
              case A1_case_1
              solve( (#vr.5, 0) ~~> (#vk, 0) )
                case Var_fresh_na
                solve( !KU( PRF(~k, ~r1) ) @ #vk.16 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.18 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case A1_case_2
              solve( (#vr.5, 0) ~~> (#vk, 0) )
                case Var_fresh_na
                solve( !KU( PRF(~k, ~r1) ) @ #vk.17 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case B1_case_1
              by solve( (#vr.5, 0) ~~> (#vk, 0) )
            next
              case B1_case_2
              by solve( (#vr.5, 0) ~~> (#vk, 0) )
            next
              case EncOracle_case_1
              by contradiction /* cyclic */
            next
              case EncOracle_case_2
              by contradiction /* cyclic */
            next
              case EncOracle_case_3
              by contradiction /* cyclic */
            next
              case EncOracle_case_4
              by contradiction /* cyclic */
            next
              case EncOracle_case_5
              by contradiction /* cyclic */
            next
              case EncOracle_case_6
              by contradiction /* cyclic */
            next
              case EncOracle_case_7
              by contradiction /* cyclic */
            next
              case EncOracle_case_8
              by contradiction /* cyclic */
            next
              case c_exp
              by contradiction /* cyclic */
            qed
          next
            case EncOracle
            solve( !KU( x^inv((x.1*PRF(~k, ~r))) ) @ #vk.10 )
              case A1_case_1
              by contradiction /* impossible chain */
            next
              case A1_case_2
              by contradiction /* impossible chain */
            next
              case B1_case_1
              by contradiction /* impossible chain */
            next
              case B1_case_2
              by contradiction /* impossible chain */
            next
              case EncOracle_case_1
              by contradiction /* cyclic */
            next
              case EncOracle_case_2
              by contradiction /* cyclic */
            next
              case EncOracle_case_3
              by contradiction /* cyclic */
            next
              case EncOracle_case_4
              by contradiction /* cyclic */
            next
              case EncOracle_case_5
              by contradiction /* cyclic */
            next
              case EncOracle_case_6
              by contradiction /* cyclic */
            next
              case EncOracle_case_7
              by contradiction /* cyclic */
            next
              case EncOracle_case_8
              by contradiction /* cyclic */
            next
              case c_exp
              by contradiction /* cyclic */
            qed
          next
            case c_h
            solve( !KU( x^inv((x.1*PRF(~k, ~r))) ) @ #vk.10 )
              case A1_case_1
              solve( (#vr.5, 0) ~~> (#vk, 0) )
                case Var_fresh_na
                solve( !KU( PRF(~k, ~r1) ) @ #vk.16 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.18 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case A1_case_2
              solve( (#vr.5, 0) ~~> (#vk, 0) )
                case Var_fresh_na
                solve( !KU( PRF(~k, ~r1) ) @ #vk.17 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            next
              case B1_case_1
              by solve( (#vr.5, 0) ~~> (#vk, 0) )
            next
              case B1_case_2
              by solve( (#vr.5, 0) ~~> (#vk, 0) )
            next
              case EncOracle_case_1
              by contradiction /* cyclic */
            next
              case EncOracle_case_2
              by contradiction /* cyclic */
            next
              case EncOracle_case_3
              by contradiction /* cyclic */
            next
              case EncOracle_case_4
              by contradiction /* cyclic */
            next
              case EncOracle_case_5
              by contradiction /* cyclic */
            next
              case EncOracle_case_6
              by contradiction /* cyclic */
            next
              case EncOracle_case_7
              by contradiction /* cyclic */
            next
              case EncOracle_case_8
              by contradiction /* cyclic */
            next
              case c_exp
              by contradiction /* cyclic */
            qed
          qed
        next
          case EncOracle_case_7
          solve( !KU( x^(x.1*inv((x.2*PRF(~k, ~r)))) ) @ #vk.10 )
            case A1_case_1
            solve( (#vr.5, 0) ~~> (#vk, 0) )
              case Var_fresh_na
              solve( !KU( h(~na) ) @ #vk.10 )
                case A2
                by contradiction /* cyclic */
              next
                case B1
                solve( !KU( PRF(~k, ~r) ) @ #vk.18 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle
                by contradiction /* impossible chain */
              next
                case c_h
                solve( !KU( PRF(~k, ~r) ) @ #vk.18 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.19 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case A1_case_2
            solve( (#vr.5, 0) ~~> (#vk, 0) )
              case Var_fresh_na
              solve( !KU( h(~na) ) @ #vk.10 )
                case A2
                by contradiction /* cyclic */
              next
                case B1
                solve( !KU( PRF(~k, ~r) ) @ #vk.20 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.22 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle
                by contradiction /* impossible chain */
              next
                case c_h
                solve( !KU( PRF(~k, ~r) ) @ #vk.20 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.22 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case A1_case_3
            solve( (#vr.5, 0) ~~> (#vk, 0) )
              case Var_fresh_na
              solve( !KU( h(~na) ) @ #vk.10 )
                case A2
                by contradiction /* cyclic */
              next
                case B1
                solve( !KU( PRF(~k, ~r1) ) @ #vk.21 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.23 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle
                by contradiction /* impossible chain */
              next
                case c_h
                solve( !KU( PRF(~k, ~r1) ) @ #vk.21 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.23 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case A1_case_4
            solve( (#vr.5, 0) ~~> (#vk, 0) )
              case Var_fresh_na
              solve( !KU( h(~na) ) @ #vk.10 )
                case A2
                by contradiction /* cyclic */
              next
                case B1
                solve( !KU( PRF(~k, ~r1) ) @ #vk.20 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.22 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              next
                case EncOracle
                by contradiction /* impossible chain */
              next
                case c_h
                solve( !KU( PRF(~k, ~r1) ) @ #vk.20 )
                  case EncOracle
                  by contradiction /* cyclic */
                next
                  case c_PRF
                  solve( !KU( ~k ) @ #vk.22 )
                    case EncOracle
                    by contradiction /* cyclic */
                  qed
                qed
              qed
            qed
          next
            case B1_case_1
            by solve( (#vr.5, 0) ~~> (#vk, 0) )
          next
            case B1_case_2
            by solve( (#vr.5, 0) ~~> (#vk, 0) )
          next
            case B1_case_3
            by solve( (#vr.5, 0) ~~> (#vk, 0) )
          next
            case B1_case_4
            by solve( (#vr.5, 0) ~~> (#vk, 0) )
          next
            case EncOracle_case_01
            by contradiction /* cyclic */
          next
            case EncOracle_case_02
            by contradiction /* cyclic */
          next
            case EncOracle_case_03
            by contradiction /* cyclic */
          next
            case EncOracle_case_04
            by contradiction /* cyclic */
          next
            case EncOracle_case_05
            by contradiction /* cyclic */
          next
            case EncOracle_case_06
            by contradiction /* cyclic */
          next
            case EncOracle_case_07
            by contradiction /* cyclic */
          next
            case EncOracle_case_08
            by contradiction /* cyclic */
          next
            case EncOracle_case_09
            by contradiction /* cyclic */
          next
            case EncOracle_case_10
            by contradiction /* cyclic */
          next
            case EncOracle_case_11
            by contradiction /* cyclic */
          next
            case EncOracle_case_12
            by contradiction /* cyclic */
          next
            case EncOracle_case_13
            by contradiction /* cyclic */
          next
            case EncOracle_case_14
            by contradiction /* cyclic */
          next
            case EncOracle_case_15
            by contradiction /* cyclic */
          next
            case EncOracle_case_16
            by contradiction /* cyclic */
          next
            case EncOracle_case_17
            by contradiction /* cyclic */
          next
            case EncOracle_case_18
            by contradiction /* cyclic */
          next
            case EncOracle_case_19
            by contradiction /* cyclic */
          next
            case EncOracle_case_20
            by contradiction /* cyclic */
          next
            case EncOracle_case_21
            by contradiction /* cyclic */
          next
            case EncOracle_case_22
            by contradiction /* cyclic */
          next
            case EncOracle_case_23
            by contradiction /* cyclic */
          next
            case EncOracle_case_24
            by contradiction /* cyclic */
          next
            case c_exp
            by contradiction /* cyclic */
          qed
        qed
      qed
    qed
  qed
qed

end